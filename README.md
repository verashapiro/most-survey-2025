# Опрос "Мост 2025"

## Обзор проекта
Данный проект представляет собой онлайн-опрос "Мост 2025", совместную инициативу проектов "Мост" и "Ковчег". Опрос предназначен для сбора информации о том, как изменились разговоры людей о войне и политике в 2025 году.

Техническая реализация проекта состоит из:
- Клиентской части на JavaScript с использованием библиотеки SurveyJS
- Серверной части на Node.js с Express
- Интеграции с Google Sheets для безопасного хранения ответов без авторизации пользователей

## Структура проекта
```
project-root/
├── server.js                   # Основной серверный файл
├── package.json                # Конфигурация Node.js проекта
├── .env                        # Файл с переменными окружения (секретные данные)
├── .env.example                # Пример файла с переменными окружения
├── README.md                   # Этот файл документации
│
├── public/                     # Каталог с клиентскими файлами (статика)
│   ├── index.html              # HTML-страница опроса
│   ├── index.js                # JavaScript для работы опроса
│   ├── json.js                 # Структура опроса (вопросы)
│   ├── theme.js                # Настройки темы SurveyJS
│   ├── index.css               # Стили опроса
│   ├── favicon.png             # Фавикон сайта
│   └── Survey_Most_Ark.png     # Логотип опроса
```

## Запуск проекта

### Предварительные требования
- Node.js версии 14.0.0 или выше
- Доступ к Google Cloud Platform и Google Sheets API
- npm или yarn

### Шаги по установке и запуску

1. Клонировать репозиторий
2. Установить зависимости:
   ```bash
   npm install
   ```

3. Создать файл `.env` на основе `.env.example` и заполнить необходимые данные:
   - `GOOGLE_SERVICE_ACCOUNT_EMAIL` - email сервисного аккаунта Google
   - `GOOGLE_PRIVATE_KEY` - приватный ключ сервисного аккаунта
   - `SPREADSHEET_ID` - ID Google Таблицы для сохранения данных
   - `PORT` - порт для запуска сервера (по умолчанию 3000)

4. Запустить сервер:
   ```bash
   npm start
   ```

5. Для разработки можно использовать режим с автоматической перезагрузкой:
   ```bash
   npm run dev
   ```

6. Открыть браузер и перейти по адресу http://localhost:3000

## Настройка Google Sheets
Для корректной работы приложения необходимо:

1. Создать проект в Google Cloud Platform
2. Включить Google Sheets API
3. Создать сервисный аккаунт с правами редактирования
4. Создать ключ для сервисного аккаунта в формате JSON
5. Создать Google Таблицу с заголовками для полей опроса
6. Предоставить сервисному аккаунту доступ к таблице

## Модификация опроса

### Изменение структуры опроса
Для изменения вопросов, вариантов ответов и структуры опроса:
1. Отредактируйте файл `public/json.js`
2. Убедитесь, что имена полей (свойство name у элементов опроса) соответствуют обработчику в серверной части (server.js, массив fieldOrder)

### Изменение внешнего вида опроса
Для изменения внешнего вида:
1. Отредактируйте файл `public/theme.js` для изменения общих параметров темы
2. Отредактируйте файл `public/index.css` для тонкой настройки стилей
3. Для замены логотипа и фавикона замените соответствующие файлы или измените пути к ним в public/json.js и public/index.html

## Безопасность и поддержка

### Безопасность
- Файл `.env` содержит секретные данные и не должен включаться в репозиторий
- Сервисный аккаунт Google должен иметь минимальные необходимые разрешения
- Рекомендуется регулярно обновлять зависимости проекта
- В продакшн-окружении рекомендуется использовать HTTPS

### Поддержка и обновление
- Регулярно проверяйте журналы сервера на наличие ошибок
- Периодически проверяйте, что Google Таблица доступна и данные сохраняются корректно
- При обновлении проекта обязательно тестируйте все функции, включая отправку данных

## Устранение неполадок

### Проблемы с сервером
- `Error: Cannot find module` - убедитесь, что все зависимости установлены (`npm install`)
- `Error: listen EADDRINUSE` - порт уже используется, измените порт в файле `.env` или остановите другой процесс

### Проблемы с Google Sheets
- `Error: unauthorized_client` - проверьте правильность учетных данных в `.env`
- `Error: insufficient_permissions` - проверьте, что сервисный аккаунт имеет доступ к таблице

### Проблемы с клиентской частью
- Не отображается логотип - проверьте путь к файлу в `json.js`
- Не отправляются данные - проверьте консоль браузера на наличие ошибок и соединение с сервером

## Лицензия и авторы
- Разработано для проектов "Мост" и "Ковчег"
- Контакты для обратной связи: [указать контактную информацию]

© 2025 Мост и Ковчег. Все права защищены.